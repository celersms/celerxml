// Permission is granted, free of charge, to any person obtaining a copy of this software and associated
// documentation, to deal in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
// to permit persons to whom the Software is furnished to do so, subject to the condition that this
// copyright shall be included in all copies or substantial portions of the Software:
// Copyright Victor Celer, 2025
package com.celerxml;

final class Chr{

   final byte[] TXT, ATT, NAM, DTD, OTH;
   static final byte[] PUB;
   private static final int[] sXml10S, sXml10;
   private static Chr sAscii, sLat1;
   private static final Chr sUtf8;

   static{
      byte[] bchars = PUB = new byte[256];
      for(int i = 0x41; i <= 0x5A; ++i)
         bchars[i] = bchars[i | 0x20] = 1; // PUBID_OK
      for(int i = 0x39; i <= 0x39; ++i)
         bchars[i] = 1; // PUBID_OK
      bchars[0x0A] = bchars[0x0D] = bchars[0x20] = bchars[0x21] = bchars[0x23] = bchars[0x24] = bchars[0x25] = bchars[0x27] =
                     bchars[0x28] = bchars[0x29] = bchars[0x2A] = bchars[0x2B] = bchars[0x2C] = bchars[0x2D] = bchars[0x2E] =
                     bchars[0x2F] = bchars[0x3A] = bchars[0x3B] = bchars[0x3D] = bchars[0x3F] = bchars[0x40] = bchars[0x5F] = 1; // PUBID_OK
      bchars = null;
      Chr chr = sUtf8 = new Chr();
      bchars = chr.OTH;
      do8bTxt(chr.TXT);
      doMbTxt(chr.TXT);
      do8bAttr(chr.ATT);
      doMbTxt(chr.ATT);
      do8bName(chr.NAM);
      doMbTxt(chr.NAM);
      do8bDtd(chr.DTD);
      doMbTxt(chr.DTD);
      do8bTxt(bchars);
      doMbTxt(bchars);
      bchars[0x26] = bchars[0x3C] = 0;
      bchars[0x2D] = 13; // HYPHEN
      bchars[0x3E] = 17; // GT
      bchars[0x3F] = 12; // QMARK
      bchars[0x5D] = 11; // RBRACKET

      int[] chars = sXml10S = new int[394];
      chars[2]   = 0x87FFFFFE; // 0x41 - 0x5A, 0x5F
      chars[3]   = 0x07FFFFFE; // 0x61 - 0x7A
      chars[6]   = chars[7]   = 0xFF7FFFFF; // 0xC0 - 0xD6, 0xD8 - 0xF6 | 0xF8 - 0xFF
      chars[8]   = 0xFFFFFFFF; // 0x100 - 0x131
      chars[9]   = 0x7FF3FFFF; // 0x134 - 0x13E
      chars[10]  = 0xFFFFFDFE; // 0x141 - 0x148, 0x14A - 0x17E
      chars[11]  = 0x7FFFFFFF;
      chars[12]  = chars[13]  = 0xFFFFFFFF; // 0x180 - 0x1C3
      chars[14]  = 0xFFFFE00F; // 0x1CD - 0x1F0
      chars[15]  = 0xFC31FFFF; // 0x1F4, 0x1F5, 0x1FA - 0x217
      chars[16]  = 0x00FFFFFF;
      chars[18]  = 0xFFFF0000; // 0x250 - 0x2A8
      chars[19]  = chars[20]  = 0xFFFFFFFF;
      chars[21]  = 0xF80001FF; // 0x2BB - 0x2C1
      chars[22]  = 0x00000003;
      chars[28]  = 0xFFFFD740; // 0x386, 0x388 - 0x38A, 0x38C, 0x38E - 0x3A1
      chars[29]  = 0xFFFFFFFB; // 0x3A3 - 0x3CE
      chars[30]  = 0x547F7FFF; // 0x3D0 - 0x3D6, 0x3DA, 0x3DC, 0x3DE
      chars[31]  = 0x000FFFFD; // 0x3E0, 0x3E2 - 0x3F3
      chars[32]  = 0xFFFFDFFE; // 0x401 - 0x40C, 0x40E - 0x44F
      chars[33]  = 0xFFFFFFFF;
      chars[34]  = 0xDFFEFFFF; // 0x451 - 0x45C, 0x45E - 0x481
      chars[35]  = 0xFFFFFFFF;
      chars[36]  = 0xFFFF0003; // 0x490 - 0x4C4
      chars[37]  = 0xFFFFFFFF;
      chars[38]  = 0xFFFF199F; // 0x4C7 - 0x4C8, 0x4CB, 0x4CC, 0x4D0 - 0x4EB
      chars[39]  = 0x033FCFFF; // 0x4EE - 0x4F5, 0x4F8, 0x4F9
      chars[41]  = 0xFFFe0000; // 0x531 - 0x556
      chars[42]  = 0x027FFFFF; // 0x559
      chars[43]  = 0xFFFFFFFE; // 0x561 - 0x586
      chars[44]  = 0x0000007F;
      chars[46]  = 0xFFFF0000; // 0x5D0 - 0x5EA
      chars[47]  = 0x000707FF; // 0x5F0 - 0x5F2
      chars[49]  = 0x07FFFFFE; // 0x621 - 0x63A
      chars[50]  = 0x000007FE; // 0x641 - 0x64A
      chars[51]  = 0xFFFE0000; // 0x671 - 0x6B7
      chars[52]  = 0xFFFFFFFF;
      chars[53]  = 0x7CFFFFFF; // 0x6BA - 0x6BE
      chars[54]  = 0x002F7FFF; // 0x6C0 - 0x6CE, 0x6D0 - 0x6D3, 0x6D5
      chars[55]  = 0x00000060; // 0x6E5, 0x6E6
      chars[72]  = 0xFFFFFFE0; // 0x905 - 0x939
      chars[73]  = 0x23FFFFFF; // 0x93D
      chars[74]  = 0xFF000000; // 0x958 - 0x961
      chars[75]  = 0x00000003;
      chars[76]  = 0xFFF99FE0; // 0x985 - 0x98C, 0x98F, 0x990, 0x993 - 0x9A8
      chars[77]  = 0x03C5FDFF; // 0x9AA - 0x9B0, 0x9B2, 0x9B6 - 0x9B9
      chars[78]  = 0xB0000000; // 0x9DC, 0x9DD, 0x9DF - 0x9E1
      chars[79]  = 0x00030003; // 0x9F0, 0x9F1
      chars[80]  = 0xFFF987E0; // 0xA05 - 0xA0A, 0xA0F, 0xA10, 0xA13 - 0xA28
      chars[81]  = 0x036DFDFF; // 0xA2A - 0xA30, 0xA32, 0xA33, 0xA35, 0xA36, 0xA38, 0xA39
      chars[82]  = 0x5E000000; // 0xA59 - 0xA5C, 0xA5E
      chars[83]  = 0x001C0000; // 0xA72 - 0xA74
      chars[84]  = 0xFFFBAFE0; // 0xA85 - 0xA8B, 0xA8D, 0xA8F - 0xA91, 0xA93 - 0xAA8
      chars[85]  = 0x23EDFDFF; // 0xAAA - 0xAB0, 0xAB2, 0xAB3, 0xAB5 - 0xAB9, 0xABD
      chars[87]  = 0x00000001; // 0xAE0
      chars[88]  = 0xFFF99FE0; // 0xB05 - 0xB0C, 0xB0F, 0xB10, 0xB13 - 0xB28
      chars[89]  = 0x23CDFDFF; // 0xB2A - 0xB30, 0xB32, 0xB33, 0xB36 - 0xB39, 0xB3D
      chars[90]  = 0xB0000000; // 0xB5C, 0xB5D, 0xB5F - 0xB61
      chars[91]  = 0x00000003;
      chars[92]  = 0xD63DC7E0; // 0xB85 - 0xB8A, 0xB8E - 0xB90, 0xB92 - 0xB95, 0xB99, 0xB9A, 0xB9C, 0xB9E, 0xB9F
      chars[93]  = 0x03BFC718; // 0xBA3, 0xBA4, 0xBA8 - 0xBAA, 0xBAE - 0xBB5, 0xBB7 - 0xBB9
      chars[96]  = 0xFFFDDFE0; // 0xC05 - 0xC0C, 0xC0E - 0xC10, 0xC12 - 0xC28
      chars[97]  = 0x03EFFDFF; // 0xC2A - 0xC33, 0xC35 - 0xC39
      chars[99]  = 0x00000003; // 0xC60, 0xC61
      chars[100] = 0xFFFDDFE0; // 0xC85 - 0xC8C, 0xC8E - 0xC90, 0xC92 - 0xCA8
      chars[101] = 0x03EFFDFF; // 0xCAA - 0xCB3, 0xCB5 - 0xCB9
      chars[102] = 0x40000000; // 0xCDE
      chars[103] = 0x00000003; // 0xCE0, 0xCE1
      chars[104] = 0xFFFDDFE0; // 0xD05 - 0xD0C, 0xD0E - 0xD10, 0xD12 - 0xD28
      chars[105] = 0x03FFFDFF; // 0xD2A - 0xD39
      chars[107] = 0x00000003; // 0xD60, 0xD61
      chars[112] = 0xFFFFFFFE; // 0xE01 - 0xE2E
      chars[113] = 0x000D7FFF; // 0xE30, 0xE32, 0xE33
      chars[114] = 0x0000003F; // 0xE40 - 0xE45
      chars[116] = 0xFEF02596; // 0xE81, 0xE82, 0xE84, 0xE87, 0xE88, 0xE8A, 0xE8D, 0xE94 - 0xE97, 0xE99 - 0xE9F
      chars[117] = 0x200D6CAE; // 0xEA1 - 0xEA3, 0xEA5, 0xEA7, 0xEAA, 0xEAB, 0xEAD, 0xEAE, 0xEB0, 0xEB2, 0xEB3, 0xEBD
      chars[118] = 0x0000001F; // 0xEC0 - 0xEC4
      chars[122] = 0xFFFFFEFF; // 0xF40 - 0xF47, 0xF49 - 0xF69
      chars[123] = 0x000003FF;
      chars[133] = 0xFFFFFFFF; // 0x10A0 - 0x10C5
      chars[134] = 0xFFFF003F; // 0x10D0 - 0x10F6
      chars[135] = 0x007FFFFF;
      chars[136] = 0x0007DAED; // 0x1100, 0x1102, 0x1103, 0x1105 - 0x1107, 0x1109, 0x110B, 0x110C, 0x110E - 0x1112
      chars[137] = 0x50000000; // 0x113C, 0x113E
      chars[138] = 0x82315001; // 0x1140, 0x114C, 0x114E, 0x1150, 0x1154, 0x1155, 0x1159, 0x115F - 0x1161
      chars[139] = 0x002C62AB; // 0x1163, 0x1165, 0x1167, 0x1169, 0x116D, 0x116E, 0x1172, 0x1173, 0x1175
      chars[140] = 0x40000000; // 0x119E
      chars[141] = 0xF580C900; // 0x11A8, 0x11AB, 0x11AE, 0x11AF, 0x11B7, 0x11B8, 0x11BA, 0x11BC - 0x11C2
      chars[142] = 0x00000007;
      chars[143] = 0x02010800; // 0x11EB, 0x11F0, 0x11F9
      chars[240] = chars[241] = chars[242] = chars[243] = 0xFFFFFFFF; // 0x1E00 - 0x1E9B
      chars[244] = 0x0FFFFFFF;
      chars[245] = chars[246] = 0xFFFFFFFF; // 0x1EA0 - 0x1EF9
      chars[247] = 0x03FFFFFF;
      chars[248] = 0x3F3FFFFF; // 0x1F00 - 0x1F15, 0x1F18 - 0x1F1D
      chars[249] = 0xFFFFFFFF; // 0x1F20 - 0x1F45
      chars[250] = 0xAAFF3F3F; // 0x1F48 - 0x1F4D, 0x1F50 - 0x1F57, 0x1F59, 0x1F5B, 0x1F5D, 0x1F5F - 0x1F7D
      chars[251] = 0x3FFFFFFF;
      chars[252] = 0xFFFFFFFF; // 0x1F80 - 0x1FB4
      chars[253] = 0x5FDFFFFF; // 0x1FB6 - 0x1FBC, 0x1FBE
      chars[254] = 0x0FCF1FDC; // 0x1FC2 - 0x1FC4, 0x1FC6 - 0x1FCC, 0x1FD0 - 0x1FD3, 0x1FD6 - 0x1FDB
      chars[255] = 0x1FDC1FFF; // 0x1FE0 - 0x1FEC, 0x1FF2 - 0x1FF4, 0x1FF6 - 0x1FFC
      chars[265] = 0x00004C40; // 0x2126, 0x212A, 0x212B, 0x212E
      chars[268] = 0x00000007; // 0x2180 - 0x2182
      chars[384] = 0x00000080; // 0x3007
      chars[385] = 0x000003FE; // 0x3021 - 0x3029
      chars[386] = 0xFFFFFFFE; // 0x3041 - 0x3094
      chars[387] = 0xFFFFFFFF;
      chars[388] = 0x001FFFFF;
      chars[389] = 0xFFFFFFFE; // 0x30A1 - 0x30FA
      chars[390] = 0xFFFFFFFF;
      chars[391] = 0x07FFFFFF;
      chars[392] = 0xFFFFFFE0; // 0x3105 - 0x312C
      chars[393] = 0x00001FFF;

      chars = sXml10 = new int[394];
      System.arraycopy(sXml10S, 0, chars, 0, 394);
      chars[1]   = 0x03FF6000; // 0x2D, 0x2E, 0x30 - 0x39
      chars[5]   = 0x00800000; // 0xB7
      chars[22]  = 0x00030003; // (0x2BB - 0x2C1) 0x2D0, 0x2D1
      chars[24]  = chars[25]  = 0xFFFFFFFF; // 0x300 - 0x345
      chars[26]  = 0x0000003F;
      chars[27]  = 0x00000003; // 0x360, 0x361
      chars[28]  = 0xFFFFD7C0; // (0x386, 0x388 - 0x38A, 0x38C, 0x38E - 0x3A1) 0x387
      chars[36]  = 0xFFFF007B; // (0x490 - 0x4C4) 0x483 - 0x486
      chars[44]  = 0xFFFE007F; // (0x561 - 0x586) 0x591 - 0x5A1
      chars[45]  = 0xBBFFFFFB; // 0x5A3 - 0x5B9, 0x5BB - 0x5BD, 0x5BF
      chars[46]  = 0xFFFF0016; // (0x5D0 - 0x5EA) 0x5C1, 0x5C2, 0x5C4
      chars[50]  = 0x0007FFFF; // (0x641 - 0x64A) 0x640, 0x64B - 0x652
      chars[51]  = 0xFFFF03FF; // (0x671 - 0x6B7) 0x660 - 0x669, 0x670
      chars[54]  = 0xFFEF7FFF; // (0x6C0 - 0x6CE, 0x6D0 - 0x6D3, 0x6D5) 0x6D6 - 0x6DC, 0x6DD - 0x6DF
      chars[55]  = 0x03FF3DFF; // (0x6E5, 0x6E6) 0x6E0 - 0x6E4, 0x6E7, 0x6E8, 0x6EA - 0x6ED, 0x6F0 - 0x6F9
      chars[72]  = 0xFFFFFFEE; // (0x905 - 0x939) 0x901 - 0x903
      chars[73]  = 0xF3FFFFFF; // (0x93D) 0x93C, 0x93E - 0x94C
      chars[74]  = 0xFF1E3FFF; // (0x958 - 0x961) 0x94D, 0x951 - 0x954
      chars[75]  = 0x0000FFCF; // 0x962, 0x963, 0x966 - 0x96F
      chars[76]  = 0xFFF99FEE; // (0x985 - 0x98C, 0x98F, 0x990, 0x993 - 0x9A8) 0x981, 0x983
      chars[77]  = 0xD3C5FDFF; // (0x9AA - 0x9B0, 0x9B2, 0x9B6 - 0x9B9) 0x9BC, 0x9BE, 0x9BF
      chars[78]  = 0xB080399F; // (0x9DC, 0x9DD, 0x9DF - 0x9E1) 0x9C0 - 0x9C4, 0x9C7, 0x9C8, 0x9CB - 0x9CD, 0x9D7
      chars[79]  = 0x0003FFCF; // (0x9F0, 0x9F1) 0x9E2, 0x9E3, 0x9E6 - 0x9EF
      chars[80]  = 0xFFF987E4; // (0xA05 - 0xA0A, 0xA0F, 0xA10, 0xA13 - 0xA28) 0xA02
      chars[81]  = 0xD36DFDFF; // (0xA2A - 0xA30, 0xA32, 0xA33, 0xA35, 0xA36, 0xA38, 0xA39) 0xA3C, 0xA3E, 0xA3F
      chars[82]  = 0x5E003987; // (0xA59 - 0xA5C, 0xA5E) 0xA40, 0xA42, 0xA47, 0xA48, 0xA4B, 0xA4D
      chars[83]  = 0x001FFFC0; // (0xA72 - 0xA74) 0xA66 - 0xA71
      chars[84]  = 0xFFFBAFEE; // (0xA85 - 0xA8B, 0xA8D, 0xA8F - 0xA91, 0xA93 - 0xAA8) 0xA81 - 0xA83
      chars[85]  = 0xF3EDFDFF; // (0xAAA - 0xAB0, 0xAB2, 0xAB3, 0xAB5 - 0xAB9, 0xABD) 0xABC, 0xABE - 0xAC5
      chars[86]  = 0x00003BBF; // 0xAC7 - 0xAC9, 0xACB - 0xACD
      chars[87]  = 0x0000FFC1; // (0xAE0) 0xAE6, 0xAEF
      chars[88]  = 0xFFF99FEE; // (0xB05 - 0xB0C, 0xB0F, 0xB10, 0xB13 - 0xB28) 0xB01 - 0xB03
      chars[89]  = 0xF3CDFDFF; // (0xB2A - 0xB30, 0xB32, 0xB33, 0xB36 - 0xB39, 0xB3D) 0xB3C, 0xB3E - 0xB43
      chars[90]  = 0xB0C0398F; // (0xB5C, 0xB5D, 0xB5F - 0xB61) 0xB47, 0xB48, 0xB4B - 0xB4D, 0xB56, 0xB57
      chars[91]  = 0x0000FFC3; // 0xB66 - 0xB6F
      chars[92]  = 0xD63DC7EC; // (0xB85 - 0xB8A, 0xB8E - 0xB90, 0xB92 - 0xB95, 0xB99, 0xB9A, 0xB9C, 0xB9E, 0xB9F) 0xB82, 0xB83
      chars[93]  = 0xC3BFC718; // (0xBA3, 0xBA4, 0xBA8 - 0xBAA, 0xBAE - 0xBB5, 0xBB7 - 0xBB9) 0xBBE - 0xBC2
      chars[94]  = 0x00803DC7; // 0xBC6 - 0xBC8, 0xBCA - 0xBCD, 0xBD7
      chars[95]  = 0x0000FF80; // 0xBE7 - 0xBEF
      chars[96]  = 0xFFFDDFEE; // (0xC05 - 0xC0C, 0xC0E - 0xC10, 0xC12 - 0xC28) 0xC01 - 0xC03
      chars[97]  = 0xC3EFFDFF; // (0xC2A - 0xC33, 0xC35 - 0xC39) 0xC3E - 0xC44
      chars[98]  = 0x00603DDF; // 0xC46 - 0xC48, 0xC4A - 0xC4D, 0xC55, 0xC56
      chars[99]  = 0x0000FFC3; // (0xC60, 0xC61) 0xC66 - 0xC6F
      chars[100] = 0xFFFDDFEC; // (0xC85 - 0xC8C, 0xC8E - 0xC90, 0xC92 - 0xCA8) 0xC82, 0xC83
      chars[101] = 0xC3EFFDFF; // (0xCAA - 0xCB3, 0xCB5 - 0xCB9) 0xCBE - 0xCC4
      chars[102] = 0x40603DDF; // (0xCDE) 0xCC6 - 0xCC8, 0xCCA - 0xCCD, 0xCD5, 0xCD6
      chars[103] = 0x0000FFC3; // (0xCE0, 0xCE1) 0xCE6 - 0xCEF
      chars[104] = 0xFFFDDFEC; // (0xD05 - 0xD0C, 0xD0E - 0xD10, 0xD12 - 0xD28) 0xD02, 0xD03
      chars[105] = 0xC3FFFDFF; // (0xD2A - 0xD39) 0xD3E - 0xD43
      chars[106] = 0x00803DCF; // 0xD46 - 0xD48, 0xD4A - 0xD4D, 0xD57
      chars[107] = 0x0000FFC3; // (0xD60, 0xD61) 0xD66 - 0xD6F
      chars[113] = 0x07FF7FFF; // (0xE30, 0xE32, 0xE33) 0xE31, 0xE34 - 0xE3A
      chars[114] = 0x03FF7FFF; // (0xE40 - 0xE45) 0xE46 - 0xE4E, 0xE50 - 0xE59
      chars[117] = 0x3BFF6CAE; // (0xEA1 - 0xEA3, 0xEA5, 0xEA7, 0xEAA, 0xEAB, 0xEAD, 0xEAE, 0xEB0, 0xEB2, 0xEB3, 0xEBD) 0xEB1, 0xEB4, 0xEB9, 0xEBB, 0xEBC
      chars[118] = 0x03FF3F5F; // (0xEC0 - 0xEC4) 0xEC6, 0xEC8 - 0xECD, 0xED0 - 0xED9
      chars[120] = 0x03000000; // 0xF18, 0xF19
      chars[121] = 0xC2A003FF; // 0xF20 - 0xF29, 0xF35, 0xF37, 0xF39, 0xF3E, 0xF3F
      chars[123] = 0xFFFE03FF; // 0xF71 - 0xF84
      chars[124] = 0xFEBF0FDF; // 0xF86 - 0xF8B, 0xF90 - 0xF95, 0xF97, 0xF99 - 0xFAD
      chars[125] = 0x02FE3FFF; // 0xFB1 - 0xFB7, 0xFB9
      chars[262] = 0x1FFF0000; // 0x20D0 - 0x20DC
      chars[263] = 0x00000002; // 0x20E1
      chars[384] = 0x000000A0; // (0x3007) 0x3005
      chars[385] = 0x003EFFFE; // (0x3021 - 0x3029) 0x302A - 0x302F, 0x3031 - 0x3035
      chars[388] = 0x661FFFFF; // 0x3099, 0x309A, 0x309D, 0x309E
      chars[391] = 0x77FFFFFF; // 0x30FC - 0x30FE
   }

   Chr(){
      TXT = new byte[256];
      ATT = new byte[256];
      NAM = new byte[256];
      DTD = new byte[256];
      OTH = new byte[256];
   }

   static final Chr getUtf8(){ return sUtf8; }

   static final Chr getAscii(){
      if(sAscii == null){
         Chr chr = new Chr();
         doLat1(chr.TXT, chr.ATT, chr.NAM, chr.DTD, chr.OTH);
         doXAscii(chr.TXT);
         doXAscii(chr.ATT);
         doXAscii(chr.NAM);
         doXAscii(chr.DTD);
         doXAscii(chr.OTH);
         sAscii = chr;
      }
      return sAscii;
   }

   static final Chr getLat1(){
      if(sLat1 == null){
         Chr chr = new Chr();
         doLat1(chr.TXT, chr.ATT, chr.NAM, chr.DTD, chr.OTH);
         sLat1 = chr;
      }
      return sLat1;
   }

   static final boolean is10NS(int c){ return c > 0x312C ? (c < 0xAC00 ? c >= 0x4E00 && c <= 0x9FA5 : c <= 0xD7A3) : (sXml10S[c >> 5] & 1 << (c & 31)) != 0; }

   static final boolean is10N(int c){ return c > 0x312C ? (c < 0xAC00 ? c >= 0x4E00 && c <= 0x9FA5 : c <= 0xD7A3) : (sXml10[c >> 5] & 1 << (c & 31)) != 0; }

   private static final void doMbTxt(byte[] arr){
      for(int c = 128; c < 256; ++c){
         byte code = 1; // INVALID
         if((c & 0xE0) == 0xC0)
            code = 5; // MULTIBYTE_2
         else if((c & 0xF0) == 0xE0)
            code = 6; // MULTIBYTE_3
         else if((c & 0xF8) == 0xF0)
            code = 7;  // MULTIBYTE_4
         arr[c] = code;
      }
   }

   private static final void doXAscii(byte[] arr){
      for(int i = 128; i <= 255; ++i)
         arr[i] = 1; // INVALID
   }

   private static final void doLat1(byte[] txt, byte[] attr, byte[] name, byte[] dtd, byte[] other){
      do8bTxt(txt);
      do8bAttr(attr);
      do8bName(name);
      for(int i = 0xC0; i <= 0xFF; ++i)
         if(i != 0xD7 && i != 0xF7)
            name[i] = 3; // NAME_ANY
      name[0xB7] = 2; // NAME_NONFIRST
      do8bDtd(dtd);
      do8bTxt(other);
      other['&'] = other['<'] = 0;
      other[']'] = 11; // RBRACKET
      other['?'] = 12; // QMARK
      other['-'] = 13; // HYPHEN
   }

   private static final void doCommTxt(byte[] arr){
      for(int i = 0; i < 32; ++i)
         arr[i] = 1; // INVALID
      arr['\t'] = 0;
      arr['\r'] = 2; // WS_CR
      arr['\n'] = 3; // WS_LF
      arr['<'] = 9; // LT
   }

   private static final void do8bName(byte[] arr){
      for(int i = 0x41; i <= 0x5A; ++i)
         arr[i] = arr[i | 0x20] = 3; // NAME_ANY
      arr['_'] = 3; // NAME_ANY
      arr[':'] = 1; // NAME_COLON
      arr['-'] = arr['.'] = 2; // NAME_NONFIRST
      for(int i = '0'; i <= '9'; ++i)
         arr[i] = 2; // NAME_NONFIRST
   }

   private static final void do8bTxt(byte[] arr){
      doCommTxt(arr);
      arr['&'] = 10; // AMP
      arr[']'] = 11; // RBRACKET
   }

   private static final void do8bAttr(byte[] arr){
      doCommTxt(arr);
      arr['\t'] = 8; // WS_TAB
      arr['&'] = 10; // AMP
      arr['\''] = arr['"'] = 14; // ATTR_QUOTE
   }

   private static final void do8bDtd(byte[] arr){
      doCommTxt(arr);
      arr['\''] = arr['"'] = 8; // DTD_QUOTE
      arr['>'] = 10; // DTD_GT
      arr[']'] = 11; // RBRACKET
      arr['%'] = 12; // DTD_PERCENT
   }
}
